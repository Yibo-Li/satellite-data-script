function im2gif(ImageCell, outfile, delaytime, resize, index)
% im2gif(ImageCell, outfile, delaytime, resize, index) Make Animated GIF
%
% Developed by "Yibo Li"<gansuliyibo@126.com>
% ImageCell = {
    % imread(['img\','SMAP_L4_SM_aup_20150401T120000_Vb1010_001.h5.m.png']); ...
    % imread(['img\','SMAP_L4_SM_aup_20150415T120000_Vb1010_001.h5.m.png']); ...
    % imread(['img\','SMAP_L4_SM_aup_20150501T120000_Vb1010_001.h5.m.png']); ...
    % imread(['img\','SMAP_L4_SM_aup_20150515T120000_Vb1010_001.h5.m.png']); ...
    % imread(['img\','SMAP_L4_SM_aup_20150601T120000_Vb1010_001.h5.m.png']); ...
    % imread(['img\','SMAP_L4_SM_aup_20150615T120000_Vb1010_001.h5.m.png']); ...
    % imread(['img\','SMAP_L4_SM_aup_20150701T120000_Vb1010_001.h5.m.png']); ...
    % imread(['img\','SMAP_L4_SM_aup_20150715T120000_Vb1010_001.h5.m.png']); ...
    % imread(['img\','SMAP_L4_SM_aup_20150801T120000_Vb1010_001.h5.m.png']); ...
    % imread(['img\','SMAP_L4_SM_aup_20150815T120000_Vb1010_001.h5.m.png']); ...
    % imread(['img\','SMAP_L4_SM_aup_20150901T120000_Vb1010_001.h5.m.png']); ...
    % imread(['img\','SMAP_L4_SM_aup_20150915T120000_Vb1010_001.h5.m.png']); ...
    % imread(['img\','SMAP_L4_SM_aup_20151001T120000_Vb1010_001.h5.m.png']); ...
    % imread(['img\','SMAP_L4_SM_aup_20151015T120000_Vb1010_001.h5.m.png']); ...
    % imread(['img\','SMAP_L4_SM_aup_20151101T120000_Vb1012_001.h5.m.png']); ...
    % imread(['img\','SMAP_L4_SM_aup_20151115T120000_Vb1012_001.h5.m.png']); ...
    % imread(['img\','SMAP_L4_SM_aup_20151201T120000_Vb1012_001.h5.m.png']); ...
    % imread(['img\','SMAP_L4_SM_aup_20151215T120000_Vb1012_001.h5.m.png']); ...
    % imread(['img\','SMAP_L4_SM_aup_20160101T120000_Vb1012_001.h5.m.png']); ...
    % imread(['img\','SMAP_L4_SM_aup_20160115T120000_Vb1012_001.h5.m.png']); ...
    % imread(['img\','SMAP_L4_SM_aup_20160201T120000_Vb1012_001.h5.m.png']); ...
    % imread(['img\','SMAP_L4_SM_aup_20160215T120000_Vb1012_001.h5.m.png']); ...
    % imread(['img\','SMAP_L4_SM_aup_20160301T120000_Vb1012_001.h5.m.png'])  ...
% };                      图像数组集合
% outfile = 'out.gif'     输出GIF文件名
% delaytime = 0.2         GIF动作间隔
% resize = 0.5            可选，为控制GIF大小，对原图做缩放
% index = 256             GIF最高256色
%
% im2gif(ImageCell, 'out.gif', 0.2, 1, 256)

for i = 1:numel(ImageCell)
    img = ImageCell{i};
    img_resize = imresize(img, resize);
    [A, map] = rgb2ind(img_resize, index);
    if i==1
        imwrite(A, map, outfile, 'gif', 'LoopCount', inf, 'DelayTime', delaytime);
    else
        imwrite(A, map, outfile, 'gif', 'WriteMode', 'append', 'DelayTime', delaytime);
    end
end
